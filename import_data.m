%import_data
%Savari V2X Simulation
clear;close all;
%% 导入数据
[~, ~, raw] = xlsread('.\interop_2019_05_01_06_57_48.xlsx','interop_2019_05_01_06_57_48','A2:GK40721');
raw(cellfun(@(x) ~isempty(x) && isnumeric(x) && isnan(x),raw)) = {''};
stringVectors = string(raw(:,[1,3,4,5,6,8,25,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,175,177,184,185,186,187,188,189,190,191,192,193]));
stringVectors(ismissing(stringVectors)) = '';
raw = raw(:,[2,7,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,164,165,166,167,168,169,170,171,172,173,174,176,178,179,180,181,182,183]);

%% 将非数值元胞替换为 NaN
R = cellfun(@(x) ~isnumeric(x) && ~islogical(x),raw); % 查找非数值元胞
raw(R) = {NaN}; % 替换非数值元胞

%% 创建输出变量
data = reshape([raw{:}],size(raw));

%% 创建表
interop20190501065748 = table;

%% 将导入的数组分配给列变量名称
interop20190501065748.TimeStamp = stringVectors(:,1);
interop20190501065748.TimeStamp_ms = data(:,1);
interop20190501065748.LogRecType = categorical(stringVectors(:,2));
interop20190501065748.CPU_Util = stringVectors(:,3);
interop20190501065748.CCH_Busy = stringVectors(:,4);
interop20190501065748.SCH_Busy = stringVectors(:,5);
interop20190501065748.ChannelNumber = data(:,2);
interop20190501065748.Raw_Busy = stringVectors(:,6);
interop20190501065748.RSS = data(:,3);
interop20190501065748.DataRate = data(:,4);
interop20190501065748.WSMLength = data(:,5);
interop20190501065748.PLCPLength = data(:,6);
interop20190501065748.TxPwrLevel = data(:,7);
interop20190501065748.SafetySupp = data(:,8);
interop20190501065748.TXInterval = data(:,9);
interop20190501065748.msgID = data(:,10);
interop20190501065748.msgCnt = data(:,11);
interop20190501065748.TempId = data(:,12);
interop20190501065748.GPGSAMode = data(:,13);
interop20190501065748.secMark = data(:,14);
interop20190501065748.lat = data(:,15);
interop20190501065748.long = data(:,16);
interop20190501065748.elev = data(:,17);
interop20190501065748.semi_major_dev = data(:,18);
interop20190501065748.semi_minor_dev = stringVectors(:,7);
interop20190501065748.semi_major_orient = data(:,19);
interop20190501065748.PRNDL = data(:,20);
interop20190501065748.speed = data(:,21);
interop20190501065748.heading = data(:,22);
interop20190501065748.angle = data(:,23);
interop20190501065748.longAccel = data(:,24);
interop20190501065748.latAccel = data(:,25);
interop20190501065748.vertAccel = data(:,26);
interop20190501065748.yawRate = data(:,27);
interop20190501065748.ABSAct = data(:,28);
interop20190501065748.BrkAct = data(:,29);
interop20190501065748.StbCtrlAct = data(:,30);
interop20190501065748.TrcCtrlAct = data(:,31);
interop20190501065748.VehicleWidth = data(:,32);
interop20190501065748.VehicleLength = data(:,33);
interop20190501065748.eventHazardLights = data(:,34);
interop20190501065748.eventABSactivated = data(:,35);
interop20190501065748.eventTractionControlLoss = data(:,36);
interop20190501065748.eventStabilityControlactivated = data(:,37);
interop20190501065748.eventHardBraking = data(:,38);
interop20190501065748.eventFrontWipers = data(:,39);
interop20190501065748.eventAirBagDeployment = data(:,40);
interop20190501065748.PHCount = stringVectors(:,8);
interop20190501065748.latOffset_1 = stringVectors(:,9);
interop20190501065748.longOffset_1 = stringVectors(:,10);
interop20190501065748.elevationOffset_1 = stringVectors(:,11);
interop20190501065748.timeOffset_1 = stringVectors(:,12);
interop20190501065748.heading_1 = stringVectors(:,13);
interop20190501065748.latOffset_2 = stringVectors(:,14);
interop20190501065748.longOffset_2 = stringVectors(:,15);
interop20190501065748.elevationOffset_2 = stringVectors(:,16);
interop20190501065748.timeOffset_2 = stringVectors(:,17);
interop20190501065748.heading_2 = stringVectors(:,18);
interop20190501065748.latOffset_3 = stringVectors(:,19);
interop20190501065748.longOffset_3 = stringVectors(:,20);
interop20190501065748.elevationOffset_3 = stringVectors(:,21);
interop20190501065748.timeOffset_3 = stringVectors(:,22);
interop20190501065748.heading_3 = stringVectors(:,23);
interop20190501065748.latOffset_4 = stringVectors(:,24);
interop20190501065748.longOffset_4 = stringVectors(:,25);
interop20190501065748.elevationOffset_4 = stringVectors(:,26);
interop20190501065748.timeOffset_4 = stringVectors(:,27);
interop20190501065748.heading_4 = stringVectors(:,28);
interop20190501065748.latOffset_5 = stringVectors(:,29);
interop20190501065748.longOffset_5 = stringVectors(:,30);
interop20190501065748.elevationOffset_5 = stringVectors(:,31);
interop20190501065748.timeOffset_5 = stringVectors(:,32);
interop20190501065748.heading_5 = stringVectors(:,33);
interop20190501065748.latOffset_6 = stringVectors(:,34);
interop20190501065748.longOffset_6 = stringVectors(:,35);
interop20190501065748.elevationOffset_6 = stringVectors(:,36);
interop20190501065748.timeOffset_6 = stringVectors(:,37);
interop20190501065748.heading_6 = stringVectors(:,38);
interop20190501065748.latOffset_7 = stringVectors(:,39);
interop20190501065748.longOffset_7 = stringVectors(:,40);
interop20190501065748.elevationOffset_7 = stringVectors(:,41);
interop20190501065748.timeOffset_7 = stringVectors(:,42);
interop20190501065748.heading_7 = stringVectors(:,43);
interop20190501065748.latOffset_8 = stringVectors(:,44);
interop20190501065748.longOffset_8 = stringVectors(:,45);
interop20190501065748.elevationOffset_8 = stringVectors(:,46);
interop20190501065748.timeOffset_8 = stringVectors(:,47);
interop20190501065748.heading_8 = stringVectors(:,48);
interop20190501065748.latOffset_9 = stringVectors(:,49);
interop20190501065748.longOffset_9 = stringVectors(:,50);
interop20190501065748.elevationOffset_9 = stringVectors(:,51);
interop20190501065748.timeOffset_9 = stringVectors(:,52);
interop20190501065748.heading_9 = stringVectors(:,53);
interop20190501065748.latOffset_10 = stringVectors(:,54);
interop20190501065748.longOffset_10 = stringVectors(:,55);
interop20190501065748.elevationOffset_10 = stringVectors(:,56);
interop20190501065748.timeOffset_10 = stringVectors(:,57);
interop20190501065748.heading_10 = stringVectors(:,58);
interop20190501065748.latOffset_11 = stringVectors(:,59);
interop20190501065748.longOffset_11 = stringVectors(:,60);
interop20190501065748.elevationOffset_11 = stringVectors(:,61);
interop20190501065748.timeOffset_11 = stringVectors(:,62);
interop20190501065748.heading_11 = stringVectors(:,63);
interop20190501065748.latOffset_12 = stringVectors(:,64);
interop20190501065748.longOffset_12 = stringVectors(:,65);
interop20190501065748.elevationOffset_12 = stringVectors(:,66);
interop20190501065748.timeOffset_12 = stringVectors(:,67);
interop20190501065748.heading_12 = stringVectors(:,68);
interop20190501065748.latOffset_13 = stringVectors(:,69);
interop20190501065748.longOffset_13 = stringVectors(:,70);
interop20190501065748.elevationOffset_13 = stringVectors(:,71);
interop20190501065748.timeOffset_13 = stringVectors(:,72);
interop20190501065748.heading_13 = stringVectors(:,73);
interop20190501065748.latOffset_14 = stringVectors(:,74);
interop20190501065748.longOffset_14 = stringVectors(:,75);
interop20190501065748.elevationOffset_14 = stringVectors(:,76);
interop20190501065748.timeOffset_14 = stringVectors(:,77);
interop20190501065748.heading_14 = stringVectors(:,78);
interop20190501065748.latOffset_15 = stringVectors(:,79);
interop20190501065748.longOffset_15 = stringVectors(:,80);
interop20190501065748.elevationOffset_15 = stringVectors(:,81);
interop20190501065748.timeOffset_15 = stringVectors(:,82);
interop20190501065748.heading_15 = stringVectors(:,83);
interop20190501065748.latOffset_16 = stringVectors(:,84);
interop20190501065748.longOffset_16 = stringVectors(:,85);
interop20190501065748.elevationOffset_16 = stringVectors(:,86);
interop20190501065748.timeOffset_16 = stringVectors(:,87);
interop20190501065748.heading_16 = stringVectors(:,88);
interop20190501065748.latOffset_17 = stringVectors(:,89);
interop20190501065748.longOffset_17 = stringVectors(:,90);
interop20190501065748.elevationOffset_17 = stringVectors(:,91);
interop20190501065748.timeOffset_17 = stringVectors(:,92);
interop20190501065748.heading_17 = stringVectors(:,93);
interop20190501065748.latOffset_18 = stringVectors(:,94);
interop20190501065748.longOffset_18 = stringVectors(:,95);
interop20190501065748.elevationOffset_18 = stringVectors(:,96);
interop20190501065748.timeOffset_18 = stringVectors(:,97);
interop20190501065748.heading_18 = stringVectors(:,98);
interop20190501065748.latOffset_19 = stringVectors(:,99);
interop20190501065748.longOffset_19 = stringVectors(:,100);
interop20190501065748.elevationOffset_19 = stringVectors(:,101);
interop20190501065748.timeOffset_19 = stringVectors(:,102);
interop20190501065748.heading_19 = stringVectors(:,103);
interop20190501065748.latOffset_20 = stringVectors(:,104);
interop20190501065748.longOffset_20 = stringVectors(:,105);
interop20190501065748.elevationOffset_20 = stringVectors(:,106);
interop20190501065748.timeOffset_20 = stringVectors(:,107);
interop20190501065748.heading_20 = stringVectors(:,108);
interop20190501065748.latOffset_21 = stringVectors(:,109);
interop20190501065748.longOffset_21 = stringVectors(:,110);
interop20190501065748.elevationOffset_21 = stringVectors(:,111);
interop20190501065748.timeOffset_21 = stringVectors(:,112);
interop20190501065748.heading_21 = stringVectors(:,113);
interop20190501065748.latOffset_22 = stringVectors(:,114);
interop20190501065748.longOffset_22 = stringVectors(:,115);
interop20190501065748.elevationOffset_22 = stringVectors(:,116);
interop20190501065748.timeOffset_22 = stringVectors(:,117);
interop20190501065748.heading_22 = stringVectors(:,118);
interop20190501065748.latOffset_23 = stringVectors(:,119);
interop20190501065748.longOffset_23 = stringVectors(:,120);
interop20190501065748.elevationOffset_23 = stringVectors(:,121);
interop20190501065748.timeOffset_23 = stringVectors(:,122);
interop20190501065748.heading_23 = stringVectors(:,123);
interop20190501065748.radiusOfCurve = data(:,41);
interop20190501065748.Confidence = data(:,42);
interop20190501065748.LowBeamStatus = data(:,43);
interop20190501065748.HighBeamStatus = data(:,44);
interop20190501065748.LftTurnSig = data(:,45);
interop20190501065748.RtTurnSig = data(:,46);
interop20190501065748.HzdLgts = data(:,47);
interop20190501065748.AutoLghtCntrlOn = data(:,48);
interop20190501065748.DtimeRunLghtsOn = data(:,49);
interop20190501065748.FogLghtsOn = data(:,50);
interop20190501065748.PkgLghtsOn = data(:,51);
interop20190501065748.WiperSwFnt = stringVectors(:,124);
interop20190501065748.WiperRtFnt = data(:,52);
interop20190501065748.WiperSwRear = stringVectors(:,125);
interop20190501065748.ThrottlePos = data(:,53);
interop20190501065748.VehHght = data(:,54);
interop20190501065748.BmprHghtFnt = data(:,55);
interop20190501065748.BmprHghtRear = data(:,56);
interop20190501065748.VehMass = data(:,57);
interop20190501065748.VehType = data(:,58);
interop20190501065748.RadioMAC = categorical(stringVectors(:,126));
interop20190501065748.CertPoolGenCtr = stringVectors(:,127);
interop20190501065748.NumValCertsRemain = stringVectors(:,128);
interop20190501065748.CertChgCtr = stringVectors(:,129);
interop20190501065748.CertType = stringVectors(:,130);
interop20190501065748.MsgGenTime_us = stringVectors(:,131);
interop20190501065748.MsgGenTimeConf = stringVectors(:,132);
interop20190501065748.SecSignStatus = stringVectors(:,133);
interop20190501065748.SecVerStatus = stringVectors(:,134);
interop20190501065748.CertDigest = stringVectors(:,135);

%% 清除临时变量
clearvars data raw stringVectors R;